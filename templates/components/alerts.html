{# Weather Alerts Component #}
{# Variables: forecast (required) #}
{% if forecast.alerts %}
<div class="alerts-stack">
  {% for alert in forecast.alerts %}
  <article class="alert-modern alert-modern--{{ alert.severity_slug }}">
    <div class="alert-modern__header">
      <div class="alert-modern__badge">
        <div class="alert-modern__icon">
          <svg class="alert-modern__icon-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
        </div>
        <div class="alert-modern__text">
          <div class="alert-modern__title-row">
            <h3 class="alert-modern__title">{{ alert.event }}</h3>
            <span class="alert-modern__pill">{{ alert.severity or "Unknown" }}</span>
          </div>
          {% if alert.sent and alert.issuer %}
          <p class="alert-modern__issuer">Issued {{ alert.sent }} by {{ alert.issuer }}</p>
          {% elif alert.sent %}
          <p class="alert-modern__issuer">Issued {{ alert.sent }}</p>
          {% elif alert.issuer %}
          <p class="alert-modern__issuer">Issued by {{ alert.issuer }}</p>
          {% endif %}
        </div>
      </div>
      {% if alert.start and alert.ends and alert.start_iso and alert.end_iso %}
      <div class="alert-modern__valid">
        <div class="alert-validity" aria-label="Alert valid time">
          <div class="alert-validity__labels">
            <span>Start</span>
            <span>End</span>
          </div>
          <div
            class="alert-validity__bar"
            data-alert-start="{{ alert.start_iso | e }}"
            data-alert-end="{{ alert.end_iso | e }}"
          >
            <span class="alert-validity__marker" aria-hidden="true"></span>
          </div>
          <div class="alert-validity__times">
            <span>{{ alert.start }}</span>
            <span>{{ alert.ends }}</span>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
    {% if alert.what or alert.impacts or alert.description %}
    <div class="alert-modern__sections">
      {% if alert.what %}
      <div class="alert-modern__section">
        <div class="alert-modern__section-label">What</div>
        <p class="alert-modern__section-text">{{ alert.what }}</p>
      </div>
      {% endif %}
      {% if alert.impacts %}
      <div class="alert-modern__section">
        <div class="alert-modern__section-label">Impacts</div>
        <p class="alert-modern__section-text">{{ alert.impacts }}</p>
      </div>
      {% endif %}
      {% if not alert.what and not alert.impacts and alert.description %}
      <div class="alert-modern__section alert-modern__section--full">
        <div class="alert-modern__section-label">What</div>
        <p class="alert-modern__section-text">{{ alert.description }}</p>
      </div>
      {% elif alert.description %}
      <div class="alert-modern__section alert-modern__section--full">
        <div class="alert-modern__section-label">Details</div>
        <p class="alert-modern__section-text">{{ alert.description }}</p>
      </div>
      {% endif %}
    </div>
    {% endif %}
    {% if alert.areas %}
    <div class="alert-modern__areas" data-alert-areas>
      <div class="alert-modern__areas-header">
        <span class="alert-modern__areas-label">
          Affected counties within
          <span class="alert-modern__areas-distance" data-alert-radius-label>10</span>
          miles of current location
        </span>
        <span class="alert-modern__areas-count" data-alert-count-label></span>
      </div>
      {% set radius_options = [5, 10, 15, 20, 25, 30, 40, 50, 75, 100] %}
      <div class="alert-modern__areas-options" role="group" aria-label="County radius">
        {% for miles in radius_options %}
        <button
          type="button"
          class="alert-modern__areas-option"
          data-alert-radius="{{ miles }}"
          aria-pressed="false"
        >
          {{ miles }} mi
        </button>
        {% endfor %}
      </div>
      <div class="alert-modern__areas-list">
        {% for area in alert.areas %}
        <span
          class="alert-modern__area-tag{% if area.is_closest %} is-closest{% endif %}"
          data-distance-mi="{{ area.distance_mi }}"
        >
          <span class="alert-modern__area-name">{{ area.name }}</span>
          <span class="alert-modern__area-distance">{{ area.distance_mi }} mi</span>
        </span>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </article>
  {% endfor %}
</div>
{% elif forecast.alerts_error %}
<div class="mb-4 sm:mb-6 glass-card rounded-xl sm:rounded-2xl p-2.5 sm:p-3 border border-rose-300/20 bg-rose-500/5">
  <p class="text-rose-700 text-[11px] sm:text-xs text-center">{{ forecast.alerts_error }}</p>
</div>
{% endif %}
