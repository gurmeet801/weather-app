{# Current Weather Card Component #}
{# Variables: forecast (required) #}
{% from "components/_weather_icons.html" import get_weather_icon %}
{% set feels_value = forecast.feels_like_temperature or forecast.period.temperature %}
{% set actual_value = forecast.actual_temperature or forecast.period.temperature %}
{% set unit = forecast.feels_like_unit or forecast.period.temperatureUnit %}
{% set advisory = namespace(found=false) %}
{% if forecast.alerts %}
  {% for alert in forecast.alerts %}
    {% if alert.event and "Advisory" in alert.event %}
      {% set advisory.found = true %}
    {% endif %}
  {% endfor %}
{% endif %}
<section class="card now-card" style="--delay: 0.05s;">
  <div class="now-content">
    <div class="now-primary">
      <div class="now-icon-wrapper">
        {{ get_weather_icon(forecast.period.shortForecast, forecast.period.isDaytime) }}
      </div>
      <div class="now-temp-group">
        <div class="now-temp" data-feels-like-temp>{{ feels_value }}&deg;</div>
        <div class="now-condition">{{ forecast.period.shortForecast }}</div>
      </div>
    </div>
    <div class="now-secondary">
      <div class="now-sub" data-actual-temp>Actual {{ actual_value }}&deg;{{ unit }}</div>
      <div
        id="advisory-badge"
        class="now-advisory advisory-blink{% if not advisory.found %} hidden{% endif %}"
      >
        See advisory below
      </div>
    </div>
  </div>
  <div class="stats-grid">
    <div class="stat">
      <div class="stat-value">
        {{ forecast.period.windSpeed }}{% if forecast.period.windDirection %} {{ forecast.period.windDirection }}{% endif %}
      </div>
      <div class="stat-label">Wind</div>
    </div>
    <div class="stat">
      <div class="stat-value" data-humidity-stat>
        {% if forecast.humidity is not none %}{{ forecast.humidity }}%{% else %}--{% endif %}
      </div>
      <div class="stat-label">Humidity</div>
    </div>
    <div class="stat">
      <div class="stat-value" data-precip-stat>
        {% if forecast.precip_chance is not none %}{{ forecast.precip_chance }}%{% else %}--{% endif %}
      </div>
      <div class="stat-label">Precip</div>
    </div>
  </div>
</section>
